[id="operations-7_{context}"]
= Operations

.Iteration Start
[]
Request (0x31):

[table,tablepcwidth="100",rowcount="6",header-option="",colcount="3",cols="3,^2,10"]
|===
| Segments size | signed vInt | Size of the bitset encoding of the segments ids to iterate on. The size is the maximum segment id rounded to nearest multiple of 8. +
A value -1 indicates no segment filtering is to be done
| Segments | byte array | (Optional) Contains the segments ids bitset encoded, where each bit with value 1 represents a segment in the set. Byte order is little-endian. +
Example: segments [1,3,12,13] would result in the following encoding: +
00001010 00110000 +
size: 16 bits +
first byte: represents segments from 0 to 7, from which 1 and 3 are set +
second byte: represents segments from 8 to 15, from which 12 and 13 are set +
More details in the java.util.BitSet implementation. Segments will be sent if the previous field is not negative
| FilterConverter size | signed vInt | The size of the String representing a KeyValueFilterConverter factory name deployed on the server, or -1 if no filter will be used
| FilterConverter | UTF-8 byte array | (Optional) KeyValueFilterConverter factory name deployed on the server. Present if previous field is not negative
| BatchSize | vInt | number of entries to transfers from the server at one go
|===

Response (0x32):

[table,tablepcwidth="100",rowcount="2",header-option="",colcount="3",cols="3,^2,10"]
|===
| IterationId | String | The unique id of the iteration
|===

.Iteration Next
[]
Request (0x33):

[table,tablepcwidth="100",rowcount="2",header-option="",colcount="3",cols="3,^2,10"]
|===
| IterationId | String | The unique id of the iteration
|===

Response (0x34):

[table,tablepcwidth="100",rowcount="13",header-option="",colcount="3",cols="3,^2,10"]
|===
| Finished segments size | vInt | size of the bitset representing segments that were finished iterating
| Finished segments | byte array | bitset encoding of the segments that were finished iterating
| Entry count | vInt | How many entries are being returned
| Key 1 Length | vInt | Length of key
| Key 1 | byte array | Retrieved key
| Value 1 Length | vInt | Length of value
| Value 1 | byte array | Retrieved value
| Key 2 Length | vInt | 
| Key 2 | byte array | 
| Value 2 Length | vInt | 
| Value 2 | byte array | 
| ... continues until entry count is reached |  | 
|===

.Iteration End
[]
Request (0x35):

[table,tablepcwidth="100",rowcount="2",header-option="",colcount="3",cols="3,^2,10"]
|===
| IterationId | String | The unique id of the iteration
|===

Response (0x36):

[table,tablepcwidth="100",rowcount="2",header-option="",colcount="3",cols="3,^2,10"]
|===
| Response status | 1 byte | +0x00+ = success, if execution completed successfully +
+0x05+ = for non existent IterationId  +
|===